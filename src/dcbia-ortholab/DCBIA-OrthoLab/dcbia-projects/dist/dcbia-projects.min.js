angular.module("dcbia-projects",["checklist-model"]);angular.module("dcbia-projects").directive("projects",["$q","$routeParams","dcbia","clusterauth",function(a,b,c,d){function e(b,e,f){d.getUser().then(function(a){b.user=a});d.getScopes().then(function(a){b.userScopes=a.data[0]});b._=_;b.projects={newProject:{collections:[],type:"project",patients:"",name:"",description:""},projects:[],projectsProperties:{defaultProject:{class:""}},selectedProjectData:{},section:0,showSection:0};b.defaultProject={_id:"defaultProject",name:"All projects",type:"project",items:0};b.panel={mergedCollectionsCollapse:true,projectCollectionsCollapse:true,selectedVariablesCollapse:true,savedSubsetsCollapse:false};b.morphologicalDataCollection={collections:[],selectedCollections:[]};b.morphologicalCheckBox=false;b.clinicalDataCollection={collections:[],selectedCollections:[]};b.clinicalCheckBox=false;b.csv={};b.$watch("csv.file",function(){if(b.csv.file){b.csv.readFile().then(function(){b.$apply()})}});b.projects.getProjects=function(){return c.getProjects().then(function(a){delete b.projects.selectedProject;b.projects.projects=a.data;_.each(b.projects.projects,function(a){b.projects.projectsProperties[a._id]={class:""}})}).catch(console.error)};b.projects.create=function(a){_.each(b.clinicalDataCollection.selectedCollections,function(a){_.each(b.clinicalDataCollection.collections,function(c){if(a===c.name){b.projects.newProject.collections.push({_id:c._id})}})});_.each(b.morphologicalDataCollection.selectedCollections,function(a){_.each(b.morphologicalDataCollection.collections,function(c){if(a===c.name||a===c._id){b.projects.newProject.collections.push({_id:c._id})}})});c.createProject(a).then(function(a){return b.projects.getProjects()}).catch(console.error)};b.projects.update=function(a){a.collections={clinicalDataCollection:b.clinicalDataCollection.selectedCollections,morphologicalDataCollection:b.morphologicalDataCollection.selectedCollections};c.updateProject(a).then(function(a){return b.projects.getProjects()}).catch(console.error)};b.projects.delete=function(a){if(confirm("Are you sure you want to delete the project?")){c.deleteProject(a._id).then(function(a){return b.projects.getProjects()}).catch(console.error)}};b.projects.selectProject=function(d){if(b.projects.selectedProject){b.projects.projectsProperties[b.projects.selectedProject._id].class=""}b.projects.selectedProject=d;b.projects.projectsProperties[d._id].class="alert alert-info";b.clinicalDataCollection.selectedCollections=[];b.morphologicalDataCollection.selectedCollections=[];if(_.isObject(b.projects.selectedProject.collections)){b.clinicalDataCollection.selectedCollections=b.projects.selectedProject.collections.clinicalDataCollection;b.morphologicalDataCollection.selectedCollections=b.projects.selectedProject.collections.morphologicalDataCollection;return Promise.all([Promise.all(_.map(b.clinicalDataCollection.selectedCollections,c.getClinicalData)).then(function(a){var c=[];_.each(_.compact(_.pluck(a,"data")),function(a){c=b.projects.mergeCollections(c,a)});return c}),Promise.all(_.map(b.morphologicalDataCollection.selectedCollections,c.getMorphologicalData)).then(function(a){var c=[];_.each(_.compact(_.pluck(a,"data")),function(a){c=b.projects.mergeCollections(c,a)});return c})]).then(function(a){b.projects.selectedProjectData=b.projects.mergeCollections(a[0],a[1]);b.projects.selectedProjectDataKeys=b.projects.getProjectDataKeys(b.projects.selectedProjectData);b.projects.selectedProjectPatients=_.map(b.projects.selectedProjectData,function(a){return a.patientId})})}else{_.each(b.projects.selectedProject.collections,function(a){var c=_.find(b.clinicalDataCollection.collections,function(b){return b["_id"]===a["_id"]});if(c)b.clinicalDataCollection.selectedCollections.push(c.name);var d=_.find(b.morphologicalDataCollection.collections,function(b){return b["_id"]===a["_id"]});if(d)b.morphologicalDataCollection.selectedCollections.push(d.name)});a.all([b.clinical.getSelectedProjectData(),b.morphological.getSelectedProjectData()]).then(function(){b.projects.selectedProjectData=b.projects.mergeCollections(b.clinical.data,b.morphological.data);b.projects.selectedProjectDataKeys=b.projects.getProjectDataKeys(b.projects.selectedProjectData);b.projects.selectedProjectPatients=_.map(b.projects.selectedProjectData,function(a){return a.patientId})})}};b.projects.saveSubset=function(){if(!b.projects.analysis.name||b.projects.analysis.name==""){b.projects.analysis.name="Subset "+Date()}b.projects.analysis.collections=b.projects.selectedProject.collections;if(!b.projects.selectedProject.analyses){b.projects.selectedProject.analyses=[]}var a=false;for(var d=0;d<b.projects.selectedProject.analyses.length&&!a;d++){var e=b.projects.selectedProject.analyses[d];if(e.name==b.projects.analysis.name){b.projects.selectedProject.analyses[d]=_.clone(b.projects.analysis);a=true}}if(!a){b.projects.selectedProject.analyses.push(_.clone(b.projects.analysis))}c.updateProject(b.projects.selectedProject)};b.projects.showSubset=function(a){b.projects.analysis=_.clone(a)};b.projects.removeSubset=function(a){b.projects.selectedProject.analyses.splice(a,1);c.updateProject(b.projects.selectedProject)};b.projects.getProjectKeys=function(a){var b={};_.each(a,function(a){_.extend(b,a)});if(b._id){delete b._id}if(b._rev){delete b._rev}return _.keys(b)};b.projects.getProjectDataKeys=function(a){var b={};_.each(a,function(a){_.extend(b,a)});if(b._id){delete b._id}if(b._rev){delete b._rev}if(b.type){delete b.type}if(b.owner){delete b.owner}if(b.owners){delete b.owners}if(b.formId){delete b.formId}if(b.date){delete b.date}if(b.scope){delete b.scope}return _.keys(b)};b.projects.select=function(a){return c.getProject(a._id).then(function(a){var c=a.data;b.projects.selectedProjectKeys=b.projects.getProjectKeys([c]);return b.projects.selectProject(c)}).catch(console.error)};b.projects.clearForm=function(a){if(!a){a=confirm("Do you want to clear the current changes?")}if(a){b.projects.newProject={collections:[],type:"project",name:"",patients:"",description:""};b.morphologicalDataCollection.selectedCollections=[];b.clinicalDataCollection.selectedCollections=[]}};b.projects.getProjectItems=function(a){var c=0;if(_.isObject(a.collections)&&!_.isArray(a.collections)){_.each(a.collections.clinicalDataCollection,function(a){var d=_.find(b.clinicalDataCollection.collections,function(b){return a===b._id});if(d){c+=d.items.length}});_.each(a.collections.morphologicalDataCollection,function(a){var d=_.find(b.morphologicalDataCollection.collections,function(b){return a===b._id});if(d){c+=d.items.length}})}else{_.each(a.collections,function(a){_.each(b.clinicalDataCollection.collections,function(b){if(a._id==b._id){c+=b.items.length}});_.each(b.morphologicalDataCollection.collections,function(b){if(a._id==b._id){c+=b.items.length}})})}return c};b.projects.hasScope=function(a,b){if(a.scope===undefined){a.scope=[]}return a.scope.indexOf(b)>=0};b.projects.addRemoveScope=function(a,d,e){if(b.projects.hasScope(a,d)){a.scope.splice(a.scope.indexOf(d),1)}else{a.scope.push(d)}c.updateProject(a).then(function(a){return b.projects.getProjects()}).catch(console.error);_.each(a.collections,function(f){_.each(b.morphologicalDataCollection.collections,function(g){if(f._id===g._id){b.morphologicalDataCollection.addRemoveScope(g,d,e,a.name);c.getMorphologicalData(g._id).then(function(a){b.morphological.data=a.data;_.each(b.morphological.data,function(a){b.morphological.addRemoveScope(a,d,e,f.name)})}).catch(console.error)}});_.each(b.clinicalDataCollection.collections,function(g){if(f._id===g._id){b.clinicalDataCollection.addRemoveScope(g,d,e,a.name);c.getClinicalData(g._id).then(function(a){b.clinical.data=a.data;_.each(b.clinical.data,function(a){b.clinical.addRemoveScope(a,d,e,f.name)})}).catch(console.error)}})})};b.projects.mergeCollections=function(a,b){_.each(b,function(b){if(b&&b._attachments&&b._id){var c={};c[b._id]=b._attachments;b.attachments=c;delete b._attachments}if(b._id){delete b._id}if(b._rev){delete b._rev}if(b.owners){delete b.owners}if(b.owner){delete b.owner}var d=_.find(a,function(a){return a["patientId"]===b["patientId"]});d?_.extend(d,b):a.push(b)});_.each(a,function(a){if(a.type!=="mergedCollection"){a.type="mergedCollection"}});return a};b.projects.getFilteredAttachments=function(a){if(b.projects.attachmentsRegex&&b.projects.attachmentsRegex!=""){var c=new RegExp("^"+b.projects.attachmentsRegex.split("*").join(".*")+"$");var d=_.filter(_.keys(a),function(a){return c.test(a)});return _.pick(a,d)}else{return a}};b.projects.selectVisibleAttachments=function(a){_.each(b.projects.displayedSubset,function(c){_.each(c.attachments,function(c,d){_.each(b.projects.getFilteredAttachments(c),function(c,e){b.morphologicalDataCollection.isSelectedAttachments(d,e);b.projects.analysis.isSelectedAttachments[d][e]=a})})})};b.morphologicalDataCollection.downloadAttachment=function(a,b,c){console.log(a,b,c)};b.morphologicalDataCollection.addRemoveScope=function(a,d,e,f){if(a.scope===undefined){a.scope=[]}if(a.scope.indexOf(d)>=0&&!e){var g=true;_.each(b.projects.projects,function(b){_.each(b.collections,function(c){if(c._id===a._id&&b.name!==f){if(b.scope.indexOf(d)>=0){g=false}}})});if(g){a.scope.splice(a.scope.indexOf(d),1)}}else if(a.scope.indexOf(d)<0&&e){a.scope.push(d)}c.updateMorphologicalDataCollection(a).then(function(a){return b.morphologicalDataCollection.getMorphologicalDataCollections()}).catch(console.error)};b.morphologicalDataCollection.getMorphologicalDataCollections=function(){return c.getMorphologicalDataCollections().then(function(a){b.morphologicalDataCollection.collections=a.data}).catch(console.error)};b.morphologicalDataCollection.checkAll=function(a){b.morphologicalDataCollection.selectedCollections=[];if(a){_.each(b.morphologicalDataCollection.collections,function(a){b.morphologicalDataCollection.selectedCollections.push(a._id)})}};b.morphologicalDataCollection.isCollectionInProject=function(a){var c=false;_.each(b.morphologicalDataCollection.selectedCollections,function(b){if(a.name===b||a._id===b){c=true}});return c};b.morphologicalDataCollection.isSelectedAttachments=function(a,c){if(b.projects.analysis){if(!b.projects.analysis.isSelectedAttachments){b.projects.analysis.isSelectedAttachments={}}if(!b.projects.analysis.isSelectedAttachments[a]){b.projects.analysis.isSelectedAttachments[a]={}}if(b.projects.analysis.isSelectedAttachments[a][c]===undefined){b.projects.analysis.isSelectedAttachments[a][c]=true}return b.projects.analysis.isSelectedAttachments[a][c]}return false};b.clinicalDataCollection.addRemoveScope=function(a,d,e,f){if(a.scope===undefined){a.scope=[]}if(a.scope.indexOf(d)>=0&&!e){var g=true;_.each(b.projects.projects,function(b){_.each(b.collections,function(c){if(c._id===a._id&&b.name!==f){if(b.scope.indexOf(d)>=0){g=false}}})});if(g){a.scope.splice(a.scope.indexOf(d),1)}}else if(a.scope.indexOf(d)<0&&e){a.scope.push(d)}c.updateClinicalDataCollection(a).then(function(a){return b.clinicalDataCollection.getClinicalDataCollections()}).catch(console.error)};b.clinicalDataCollection.getClinicalDataCollections=function(){return c.getClinicalDataCollections().then(function(a){b.clinicalDataCollection.collections=a.data}).catch(console.error)};b.clinicalDataCollection.checkAll=function(a){b.clinicalDataCollection.selectedCollections=[];if(a){_.each(b.clinicalDataCollection.collections,function(a){b.clinicalDataCollection.selectedCollections.push(a._id)})}};b.clinicalDataCollection.isCollectionInProject=function(a){var c=false;_.each(b.clinicalDataCollection.selectedCollections,function(b){if(a.name===b||a._id===b){c=true}});return c};b.csv.export=function(a){var c;if(!b.projects.selectedProject||a._id!==b.projects.selectedProject._id){c=b.projects.select(a)}else{c=Promise.resolve(true)}c.then(function(){var a=b.projects.getProjectKeys([b.projects.selectedProject]);var c="name:,"+b.projects.selectedProject.name+"\n";c+="description:,"+b.projects.selectedProject.description+"\n";c+="patients:,"+b.projects.selectedProject.patients+"\n";c+="\n";var d=["Name","Number of items","Type"];c+=d.toString();c+="\n";_.each(b.projects.selectedProject.collections,function(a,d){_.each(b.clinicalDataCollection.collections,function(b){if(a._id===b._id){c+=b.name+","+b.items.length+","+b.type+"\n"}});_.each(b.morphologicalDataCollection.collections,function(b){if(a._id===b._id){c+=b.name+","+b.items.length+","+b.type+"\n"}})});var e=b.projects.selectedProject.name;if(b.projects.selectedProject.name.indexOf("csv")===-1){e+=".csv"}return b.csv.download(e,c)}).catch(console.error)};b.csv.download=function(a,b){var c=document.createElement("a");e.appendChild(c);var d=new Blob([b],{type:"text/plain"});c.setAttribute("href",window.URL.createObjectURL(d));c.setAttribute("download",a);c.dataset.downloadurl=["text/plain",c.download,c.href].join(":");c.click()};b.clinical={data:[]};b.morphological={data:[]};b.clinical.addRemoveScope=function(a,d,e,f){if(a.scope===undefined){a.scope=[]}if(a.scope.indexOf(d)>=0&&!e){var g=true;_.each(b.clinicalDataCollection.collections,function(b){_.each(b.items,function(c){if(c._id===a._id&&b.name!==f){if(b.scope.indexOf(d)>=0){g=false}}})});if(g){a.scope.splice(a.scope.indexOf(d),1)}}else if(a.scope.indexOf(d)<0&&e){a.scope.push(d)}c.updateClinicalData(a).catch(console.error)};b.clinical.getSelectedProjectData=function(){var a=_.map(b.projects.selectedProject.collections,function(a){return a._id});return Promise.all(_.map(a,c.getClinicalData)).then(function(a){b.clinical.data=[];_.each(a,function(a){b.clinical.data=b.projects.mergeCollections(b.clinical.data,a.data)});return b.clinical.data})};b.morphological.getSelectedProjectData=function(){var a=_.map(b.projects.selectedProject.collections,function(a){return a._id});return Promise.all(_.map(a,c.getMorphologicalData)).then(function(a){b.morphological.data=[];_.each(a,function(a){b.morphological.data=b.projects.mergeCollections(b.morphological.data,a.data)});return b.morphological.data})};b.morphological.addRemoveScope=function(a,d,e,f){if(a.scope===undefined){a.scope=[]}if(a.scope.indexOf(d)>=0&&!e){var g=true;_.each(b.morphologicalDataCollection.collections,function(b){_.each(b.items,function(c){if(c._id===a._id&&b.name!==f){if(b.scope.indexOf(d)>=0){g=false}}})});if(g){a.scope.splice(a.scope.indexOf(d),1)}}else if(a.scope.indexOf(d)<0&&e){a.scope.push(d)}c.updateMorphologicalData(a).catch(console.error)};b.projects.getProjects().then(function(){return b.morphologicalDataCollection.getMorphologicalDataCollections()}).then(function(){return b.clinicalDataCollection.getClinicalDataCollections()})}return{restrict:"E",link:e,templateUrl:"./src/dcbia-projects.template.html"}}]);angular.module("dcbia-projects").run(["$templateCache",function(a){"use strict"
;a.put("./src/dcbia-projects.template.html",'<div class="row">\n'+'\t<div class="panel panel-default">\n'+'  \t\t<div class="panel-body">\n'+'\t\t\t<div class="col-md-12">\n'+'\t\t\t\t<div class="btn-group">\n'+'\t\t\t\t <button type="button" class="btn btn-default" ng-click="projects.section=1;projects.showSection=clinicalDataCollection.selectedCollections=[];morphologicalDataCollection.selectedCollections=[];">\n'+'\t\t\t\t \t<span class="glyphicon glyphicon-plus"></span>\n'+"\t\t\t\t \tNew Project\n"+"\t\t\t\t </button>\n"+"\t\t\t\t</div>\n"+"\t\t\t</div>\n"+"\t\t</div>\n"+"\t</div>\n"+"</div>\n"+'<div class="row" ng-if="projects.section == 0">\n'+'\t<div class="panel panel-default">\n'+'  \t\t<div class="panel-body">\n'+'  \t\t\t<div class="col-sm-6 col-md-4">\n'+"\t\t\t\t<div ng-class=\"projects.projectProperties['defaultProject'].class\">\n"+'\t\t\t\t    <div class="thumbnail">\n'+'\t\t\t\t      <div class="caption">\n'+"\t\t\t\t        <h3>{{defaultProject.name}}</h3>\n"+"\t\t\t\t        <p>\n"+"\t\t\t\t        \t<b>Number of projects: </b> {{projects.projects.length}}\n"+"\t\t\t\t        </p>\n"+'\t\t\t        \t<div class="btn-group">\n'+'\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="projects.showSection = 0;projects.select(defaultProject)">\n'+'\t\t\t\t\t\t \t<span class="glyphicon glyphicon-refresh"></span>\n'+"\t\t\t\t\t\t </button>\n"+'\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="csv.export(defaultProject)">\n'+'\t\t\t\t\t\t \t<span class="glyphicon glyphicon-download"></span>\n'+"\t\t\t\t\t\t </button>\n"+"\t\t\t\t\t\t</div>\n"+"\t\t\t\t      </div>\n"+"\t\t\t\t    </div>\n"+"\t\t\t\t</div>\n"+"\t\t\t</div>\n"+'\t\t\t<div class="col-sm-6 col-md-4" ng-repeat="project in projects.projects">\n'+'\t\t\t\t<div ng-class="projects.projectsProperties[project._id].class">\n'+'\t\t\t\t    <div class="thumbnail">\n'+'\t\t\t\t      <div class="caption">\n'+"\t\t\t\t        <h3>{{project.name}}</h3>\n"+"\t\t\t\t        <p>\n"+"\t\t\t\t        \t<b>Number of items: </b> {{projects.getProjectItems(project)}}\n"+"\t\t\t\t        </p>\n"+'\t\t\t        \t<div class="btn-group">\n'+'\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="projects.showSection = 1;projects.select(project)">\n'+'\t\t\t\t\t\t \t<span class="glyphicon glyphicon-eye-open"></span>\n'+"\t\t\t\t\t\t </button>\n"+'\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="projects.showSection = 2;projects.select(project)">\n'+'\t\t\t\t\t\t \t<span class="glyphicon glyphicon-pencil"></span>\n'+"\t\t\t\t\t\t </button>\n"+"\n"+'\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="csv.export(project)">\n'+'\t\t\t\t\t\t \t<span class="glyphicon glyphicon-download"></span>\n'+"\t\t\t\t\t\t </button>\n"+"\n"+'\t\t\t\t\t\t <button type="button" class="btn btn-danger" ng-click="projects.delete(project)">\n'+'\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n'+"\t\t\t\t\t\t </button>\n"+"\n"+"\t\t\t\t\t\t</div>\n"+"\t\t\t\t      </div>\n"+"\t\t\t\t    </div>\n"+"\t\t\t\t</div>\n"+"\t\t\t</div>\n"+"\t\t</div>\n"+"\t</div>\n"+'\t<div class="panel panel-default" ng-if="projects.showSection == 1">\n'+'\t\t<div class="panel-heading">\n'+'\t\t\t<button class="btn btn-default" ng-click="panel.projectCollectionsCollapse=!panel.projectCollectionsCollapse">\n'+'\t\t\t\t<span ng-if="panel.projectCollectionsCollapse" class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>\n'+'\t\t\t\t<span ng-if="!panel.projectCollectionsCollapse" class="glyphicon glyphicon-collapse-up" aria-hidden="true"></span>\n'+"\t\t\t</button>\n"+"\t    \tProject collections\n"+"\t  \t</div>\n"+"\t\t<div ng-class=\"panel.projectCollectionsCollapse? 'panel-body collapse': 'panel-body'\">\n"+'\t\t  \t<div class="col-md-6">\n'+'\t\t  \t\t<div class="panel panel-default" style="overflow:scroll">\n'+'\t\t\t\t\t<div class="panel-heading">\n'+"\t\t\t\t\t \tClinical collections\n"+"\t\t\t\t\t</div>\n"+'\t\t\t  \t\t<div class="panel-body">\n'+'\t\t\t  \t\t\t<table st-table="projects.selectedProject.collections" st-sort="{{key}}" class="table table-striped">\n'+"\t\t\t\t\t\t\t<thead>\n"+"\t\t\t\t\t\t\t\t<tr>\n"+"\t\t\t\t\t\t\t\t\t<th>Name</th>\n"+"\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t</thead>\n"+"\t\t\t\t\t\t\t<tbody>\n"+'\t\t\t\t\t\t\t\t<tr ng-repeat="collection in clinicalDataCollection.collections">\n'+'\t\t\t\t\t\t        \t<td ng-if="clinicalDataCollection.isCollectionInProject(collection)">\n'+'\t\t\t\t\t\t\t\t\t\t<a type="button" class="btn btn-default" href="#/clinicalData?collectionId={{collection._id}}" target="blank">\n'+"\t\t\t\t\t\t        \t\t\t{{collection.name}}\n"+"\t\t\t\t\t\t        \t\t</a>\n"+"\t\t\t\t\t\t        \t</td>\n"+'\t\t\t\t\t\t        \t<td ng-if="clinicalDataCollection.isCollectionInProject(collection)">\n'+"\t\t\t\t\t\t        \t\t{{collection.items.length}}\n"+"\t\t\t\t\t\t        \t</td>\n"+'\t\t\t\t\t\t        \t<td ng-if="clinicalDataCollection.isCollectionInProject(collection)">\n'+"\t\t\t\t\t\t        \t\t{{collection.type}}\n"+"\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t</tbody>\n"+"\t\t\t\t\t\t</table>\n"+"\t\t\t  \t\t</div>\n"+"\t\t\t  \t</div>\n"+"\t\t  \t</div>\n"+'\t\t  \t<div class="col-md-6">\n'+'\t\t\t  \t<div class="panel panel-default" style="overflow:scroll">\n'+'\t\t\t\t\t<div class="panel-heading">\n'+"\t\t\t\t\t \tMorphological collections\n"+"\t\t\t\t\t</div>\n"+'\t\t\t  \t\t<div class="panel-body">\n'+'\t\t\t  \t\t\t<table st-table="morphologicalDataCollection.collections" st-sort="{{key}}" class="table table-striped">\n'+"\t\t\t\t\t\t\t<thead>\n"+"\t\t\t\t\t\t\t\t<tr>\n"+"\t\t\t\t\t\t\t\t\t<th>Name</th>\n"+"\t\t\t\t\t\t\t\t\t<th>Number of items</th>\n"+"\t\t\t\t\t\t\t\t\t<th>Type</th> \n"+"\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t</thead>\n"+"\t\t\t\t\t\t\t<tbody>\n"+'\t\t\t\t\t\t\t\t<tr ng-repeat="collection in morphologicalDataCollection.collections">\n'+'\t\t\t\t\t\t        \t<td ng-if="morphologicalDataCollection.isCollectionInProject(collection)">\n'+'\t\t\t\t\t\t\t\t\t\t<a type="button" class="btn btn-default" href="#/morphologicalData?collectionId={{collection._id}}" target="blank">\n'+"\t\t\t\t\t\t        \t\t\t{{collection.name}}\n"+"\t\t\t\t\t\t        \t\t</a>\n"+"\t\t\t\t\t\t        \t</td>\n"+'\t\t\t\t\t\t        \t<td ng-if="morphologicalDataCollection.isCollectionInProject(collection)">\n'+"\t\t\t\t\t\t        \t\t{{collection.items.length}}\n"+"\t\t\t\t\t\t        \t</td>\n"+'\t\t\t\t\t\t        \t<td ng-if="morphologicalDataCollection.isCollectionInProject(collection)">\n'+"\t\t\t\t\t\t        \t\t{{collection.type}}\n"+"\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t</tbody>\n"+"\t\t\t\t\t\t</table>\n"+"\t\t\t  \t\t</div>\n"+"\t\t\t  \t</div>\n"+"\t\t  \t</div>\n"+"\t\t</div>\n"+"\t</div>\t\n"+'\t<div class="panel panel-default" style="overflow:scroll" ng-if="projects.showSection == 1">\n'+'\t\t<div class="panel-heading">\n'+'\t\t\t<button class="btn btn-default" ng-click="panel.mergedCollectionsCollapse=!panel.mergedCollectionsCollapse">\n'+'\t\t\t\t<span ng-if="panel.mergedCollectionsCollapse" class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>\n'+'\t\t\t\t<span ng-if="!panel.mergedCollectionsCollapse" class="glyphicon glyphicon-collapse-up" aria-hidden="true"></span>\n'+"\t\t\t</button>\n"+"\t\t\tMerged collections\n"+"\t  \t</div>\n"+"  \t\t<div ng-class=\"panel.mergedCollectionsCollapse? 'panel-body collapse': 'panel-body'\" id=\"mergedCollections\">\n"+'  \t\t\t<table st-table="projects.displayedProject" st-safe-src="projects.selectedProjectData" class="table table-striped">\n'+"\t\t\t\t<thead>\n"+"\t\t\t\t\t<tr>\n"+'\t\t\t\t\t\t<th ng-repeat="key in projects.selectedProjectDataKeys">{{key}}</th>\n'+"\t\t\t\t\t</tr>\n"+"\t\t\t\t\t<tr>\n"+'\t\t\t\t\t\t<th ng-repeat="key in projects.selectedProjectDataKeys">\n'+'\t\t\t\t\t\t\t<input st-search="{{key}}" placeholder="search for {{key}}" class="input-sm form-control" type="search" ng-if="key!=\'attachments\'"/>\n'+'\t\t\t\t\t\t\t<input placeholder="search for attachments" class="input-sm form-control" type="search" ng-if="key==\'attachments\'" ng-model="projects.attachmentsRegex"/>\n'+"\t\t\t\t\t\t</th>\n"+"\t\t\t\t\t</tr>\n"+"\t\t\t\t</thead>\n"+"\t\t\t\t<tbody>\n"+'\t\t\t\t\t<tr ng-repeat="row in projects.displayedProject">\n'+'\t\t\t\t\t\t<td ng-repeat="key in projects.selectedProjectDataKeys">\n'+"\t\t\t\t\t\t\t<div ng-if=\"key == '_attachments'\">\n"+'\t\t\t\t\t\t\t\t<button type="button" class="btn btn-default" ng-repeat="(key, att) in row[key]" ng-click="morphologicalDataCollection.downloadAttachment(row._id, key, att)">\n'+'\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-eye"></span>{{att}}\n'+"\t\t\t\t\t\t\t\t</button>\n"+"\t\t\t\t\t\t\t\t\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t<div ng-if=\"key == 'attachments'\">\n"+'\t\t\t\t\t\t\t\t<div ng-repeat="(keycoll, collattachments) in row[key]">\t\t\t\t\t\t\t\t\t\n'+'\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-default" ng-repeat="(key, att) in collattachments" ng-click="morphologicalDataCollection.downloadAttachment(keycoll, key, att)">\n'+'\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-eye"></span>{{key}}\n'+"\t\t\t\t\t\t\t\t\t</button>\n"+"\t\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t<div ng-if=\"!_.isArray(row[key]) && key != '_attachments' && key != 'attachments'\">\n"+"\t\t\t\t\t\t\t\t{{row[key]}}\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t<div ng-if=\"_.isArray(row[key]) && key != '_attachments' && key != 'attachments'\">\n"+"\t\t\t\t\t\t\t\t<ul>\n"+'\t\t\t\t\t\t\t\t\t<li ng-repeat="item in row[key]" ng-if="key == \'owners\'">{{item.user}}</li>\n'+"\t\t\t\t\t\t\t\t</ul>\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t</td>\n"+"\t\t\t\t\t</tr>\n"+"\t\t\t\t</tbody>\n"+"\t\t\t</table>\n"+"\t\t</div>\n"+"\t</div>\n"+'\t<div class="panel panel-default" ng-if="projects.showSection == 1">\t\t\n'+'\t    <div class="panel panel-default" style="overflow:scroll" ng-if="projects.showSection == 1">\n'+'\t\t\t<div class="panel-heading">\n'+'\t\t\t\t<button class="btn btn-default" ng-click="panel.savedSubsetsCollapse=!panel.savedSubsetsCollapse">\n'+'\t\t\t\t\t<span ng-if="panel.savedSubsetsCollapse" class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>\n'+'\t\t\t\t\t<span ng-if="!panel.savedSubsetsCollapse" class="glyphicon glyphicon-collapse-up" aria-hidden="true"></span>\n'+"\t\t\t\t</button>\n"+"\t\t    \tSaved subsets\n"+"\t\t  \t</div>\n"+"\t\t  \t<div ng-class=\"panel.savedSubsetsCollapse? 'panel-body collapse': 'panel-body'\">\n"+'\t\t  \t\t<table st-table="projects.displayedAnalyses" st-safe-src="projects.selectedProject.analyses" class="table table-striped">\n'+"\t                <thead>\n"+"\t                    <tr>\n"+'\t                        <th colspan="2">\n'+'\t                            <input st-search="" placeholder="search by name" class="input-sm form-control" type="search"/>\n'+"\t                        </th>\n"+"\t                    </tr>\n"+"\t                </thead>\n"+"\t                <tbody>\n"+'\t                    <tr ng-repeat="(index, analysis) in projects.displayedAnalyses">\n'+"\t                        <td>\n"+"\t                            {{analysis.name}}\n"+"\t                        </td>\n"+"\t                        <td>\n"+'\t                            <button type="button" class="btn btn-info" ng-click="projects.showSubset(analysis)">\n'+'\t                    \t\t\t<span class="glyphicon glyphicon-eye-open"></span>\n'+"\t                 \t\t\t</button>\n"+"\t                        </td>\n"+"\t                        <td>\n"+'\t                            <button type="button" class="btn btn-warning" ng-click="projects.removeSubset(index)">\n'+'\t                    \t\t\t<span class="glyphicon glyphicon-remove"></span>\n'+"\t                 \t\t\t</button>\n"+"\t                        </td>\n"+"\t                    </tr>\n"+"\t                </tbody>\n"+"\t            </table>\n"+"\t\t  \t</div>\n"+"\t\t</div>\n"+'\t\t<div class="panel-heading">\n'+'\t\t\t<button class="btn btn-default" ng-click="panel.selectedVariablesCollapse=!panel.selectedVariablesCollapse">\n'+'\t\t\t\t<span ng-if="panel.selectedVariablesCollapse" class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>\n'+'\t\t\t\t<span ng-if="!panel.selectedVariablesCollapse" class="glyphicon glyphicon-collapse-up" aria-hidden="true"></span>\n'+"\t\t\t</button>\n"+"\t    \tSelected variables\n"+"\t  \t</div>\n"+"  \t\t<div ng-class=\"panel.selectedVariablesCollapse? 'panel-body collapse': 'panel-body'\" class=\"col-md-12\">\n"+'\t        <div class="col-md-6">\n'+'\t            <div class="btn-group">\n'+'\t                 <button type="button" class="btn btn-default" ng-click="projects.analysis.selectedVariables=projects.selectedProjectDataKeys">\n'+'\t                    <span class="glyphicon glyphicon-plus"></span>\n'+"\t                    Add all\n"+"\t                 </button>\n"+"\n"+'\t                 <button type="button" class="btn btn-default" ng-click="projects.analysis.selectedVariables=[]">\n'+'\t                    <span class="glyphicon glyphicon-remove"></span>\n'+"\t                    Remove all\n"+"\t                 </button>\n"+"\t            </div>\n"+"\n"+'\t            <table st-table="multiSeries.displayedKeys" st-safe-src="projects.selectedProjectDataKeys" class="table table-striped">\n'+"\t                <thead>\n"+"\t                    <tr>\n"+'\t                        <th colspan="2">\n'+'\t                            <input st-search="" placeholder="search by variable name" class="form-control" type="search"/>\n'+"\t                        </th>\n"+"\t                    </tr>\n"+"\t                </thead>\n"+"\t                <tbody>\n"+'\t                    <tr ng-repeat="row in multiSeries.displayedKeys">\n'+"\t                        <td>\n"+'\t                            <div class="input-group">\n'+'\t                            \t<input type="checkbox" aria-label="..." checklist-model="projects.analysis.selectedVariables" checklist-value="row">\n'+"\t                            </div>\n"+"\t                        </td>\n"+"\t                        <td>{{row}}</td>\n"+"\t                    </tr>\n"+"\t                </tbody>\n"+"\t            </table>\n"+"\t        </div>\n"+'\t        <div class="col-md-6">\n'+'\t            <div class="btn-group">\n'+'\t                 <button type="button" class="btn btn-default" ng-click="projects.analysis.selectedPatients=projects.selectedProjectPatients">\n'+'\t                    <span class="glyphicon glyphicon-plus"></span>\n'+"\t                    Add all\n"+"\t                 </button>\n"+"\n"+'\t                 <button type="button" class="btn btn-default" ng-click="projects.analysis.selectedPatients=[]">\n'+'\t                    <span class="glyphicon glyphicon-remove"></span>\n'+"\t                    Remove all\n"+"\t                 </button>\n"+"\t            </div>\n"+"\n"+'\t            <table st-table="multiSeries.displayedSubjects" st-safe-src="projects.selectedProjectPatients" class="table table-striped">\n'+"\t                <thead>\n"+"\t                    <tr>\n"+'\t                        <th colspan="2">\n'+'\t                            <input st-search="" placeholder="search by patientId " class="input-sm form-control" type="search"/>\n'+"\t                        </th>\n"+"\t                    </tr>\n"+"\t                </thead>\n"+"\t                <tbody>\n"+'\t                    <tr ng-repeat="row in multiSeries.displayedSubjects">\n'+"\t                        <td>\n"+'\t                            <div class="input-group">\n'+'\t                            <input type="checkbox" aria-label="..." checklist-model="projects.analysis.selectedPatients" checklist-value="row">\n'+"\t                            </div>\n"+"\t                        </td>\n"+"\t                        <td>{{row}}</td>\n"+"\t                    </tr>\n"+"\t                </tbody>\n"+"\t            </table>  \n"+"\t        </div>\n"+"\t    </div>\n"+"  \t</div>\n"+'  \t<div class="panel panel-default" style="overflow:scroll" ng-if="projects.showSection == 1">\n'+'\t\t<div class="panel-heading">\t    \t\n'+'\t    \t<button class="btn btn-default" ng-click="panel.selectedSubsetCollapse=!panel.selectedSubsetCollapse">\n'+'\t\t\t\t<span ng-if="panel.selectedSubsetCollapse" class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>\n'+'\t\t\t\t<span ng-if="!panel.selectedSubsetCollapse" class="glyphicon glyphicon-collapse-up" aria-hidden="true"></span>\n'+"\t\t\t</button>\n"+"\t\t\tSubset\n"+"\t  \t</div>\t\t  \t\n"+"  \t\t<div ng-class=\"panel.selectedSubsetCollapse? 'panel-body collapse': 'panel-body'\">\n"+'  \t\t\t<div class="input-group">\n'+'\t  \t\t\t<span class="input-group-addon">Name</span>\n'+'\t  \t\t\t<input type="text" class="form-control" placeholder="Subset name" aria-describedby="basic-addon3" ng-model="projects.analysis.name">\n'+"\t  \t\t</div>\n"+'  \t\t\t<div class="btn-group">\n'+'\t\t\t\t <button type="button" class="btn btn-default" ng-click="projects.saveSubset()">\n'+'\t\t\t\t \t<span class="glyphicon glyphicon-save"></span>\n'+"\t\t\t\t \tSave subset\n"+"\t\t\t\t </button>\t\t\t\t \n"+"\t\t\t</div>\t\t\t    \n"+'  \t\t\t<table st-table="projects.displayedSubset" st-safe-src="projects.selectedProjectData" class="table table-striped">\n'+"\t\t\t\t<thead>\n"+"\t\t\t\t\t<tr>\n"+'\t\t\t\t\t\t<th ng-repeat="key in projects.analysis.selectedVariables" st-sort="{{key}}">{{key}}</th>\n'+"\t\t\t\t\t</tr>\n"+"\t\t\t\t\t<tr>\n"+'\t\t\t\t\t\t<th ng-repeat="key in projects.analysis.selectedVariables">\n'+'\t\t\t\t\t\t\t<input st-search="{{key}}" placeholder="search for {{key}}" class="input-sm form-control" type="search" ng-if="key!=\'attachments\'"/>\n'+'\t\t\t\t\t\t\t<div class="input-group" ng-if="key==\'attachments\'">\n'+'\t\t\t\t\t\t\t\t<span class="input-group-btn">\n'+'\t\t\t\t\t\t  \t\t\t<button type="button" class="btn btn-sm btn-info" ng-click="projects.selectVisibleAttachments(true)">\n'+'\t\t\t                \t\t\t<span class="glyphicon glyphicon-ok"></span>\n'+"\t\t\t             \t\t\t</button>\n"+'\t\t\t             \t\t\t<button type="button" class="btn btn-sm btn-danger" ng-click="projects.selectVisibleAttachments(false)">\n'+'\t\t\t                \t\t\t<span class="glyphicon glyphicon-remove"></span>\n'+"\t\t\t             \t\t\t</button>\n"+"\t\t\t\t\t  \t\t\t</span>\n"+'\t\t\t\t\t\t\t\t<input placeholder="search for attachments" class="input-sm form-control" ng-model="projects.attachmentsRegex" type="search" />\n'+"\t\t\t\t\t  \t\t</div>\t\t\t\t\t\t\t\t\n"+"\t\t\t\t\t\t</th>\n"+"\t\t\t\t\t</tr>\n"+"\t\t\t\t</thead>\n"+"\t\t\t\t<tbody>\n"+'\t\t\t\t\t<tr ng-repeat="row in projects.displayedSubset" ng-if="projects.analysis.selectedPatients.indexOf(row.patientId)>-1">\n'+'\t\t\t\t\t\t<td ng-repeat="key in projects.analysis.selectedVariables">\t\t\t\t\t\t\t\t\n'+"\t\t\t\t\t\t\t\x3c!-- Deprecated this chunk can be removed in the future--\x3e\n"+"\t\t\t\t\t\t\t<div ng-if=\"key == '_attachments'\">\n"+'\t\t\t\t\t\t\t\t<button type="button" class="btn btn-default" ng-repeat="(key, att) in row[key]" >\n'+'\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-eye"></span>{{att}}\n'+"\t\t\t\t\t\t\t\t</button>\n"+"\t\t\t\t\t\t\t\t\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t\x3c!-- Deprecated --\x3e\n"+"\n"+"\t\t\t\t\t\t\t<div ng-if=\"key == 'attachments'\">\n"+'\t\t\t\t\t\t\t\t<div ng-repeat="(keycoll, collattachments) in row[key]">\t\n'+'\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-default" ng-repeat="(key, att) in projects.getFilteredAttachments(collattachments)" ng-click="projects.analysis.isSelectedAttachments[keycoll][key] = !projects.analysis.isSelectedAttachments[keycoll][key]">\n'+'\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-eye"></span><s ng-if="!morphologicalDataCollection.isSelectedAttachments(keycoll, key)">{{key}}</s><b ng-if="morphologicalDataCollection.isSelectedAttachments(keycoll, key)">{{key}}</b>\n'+"\t\t\t\t\t\t\t\t\t</button>\n"+"\t\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t<div ng-if=\"!_.isArray(row[key]) && key != '_attachments' && key != 'attachments'\">\n"+"\t\t\t\t\t\t\t\t{{row[key]}}\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t\t<div ng-if=\"_.isArray(row[key]) && key != '_attachments' && key != 'attachments'\">\n"+"\t\t\t\t\t\t\t\t<ul>\n"+'\t\t\t\t\t\t\t\t\t<li ng-repeat="item in row[key]" ng-if="key == \'owners\'">{{item.user}}</li>\n'+"\t\t\t\t\t\t\t\t</ul>\n"+"\t\t\t\t\t\t\t</div>\n"+"\t\t\t\t\t\t</td>\t\t\t\t\t\t\t\n"+"\t\t\t\t\t</tr>\n"+"\t\t\t\t</tbody>\n"+"\t\t\t</table>\n"+"\t\t</div>\n"+"    </div>\n"+'\t<div class="panel panel-info" ng-if="projects.showSection == 2">\n'+'\t\t<div class="panel panel-default">\n'+'\t\t  <div class="panel-body">\n'+'\t\t  \t<div class="input-group">\n'+'\t  \t\t\t<span class="input-group-addon">Name</span>\n'+'\t  \t\t\t<input type="text" class="form-control" placeholder="Project name" aria-describedby="basic-addon3" ng-model="projects.selectedProject.name">\n'+"\t  \t\t</div>\n"+'\t  \t\t<div class="input-group">\n'+'\t  \t\t\t<span class="input-group-addon">Description</span>\n'+'\t  \t\t\t<input type="text" class="form-control" placeholder="Write description of the project" aria-describedby="basic-addon3" ng-model="projects.selectedProject.description">\n'+"\t  \t\t</div>\n"+'\t  \t\t<div class="input-group">\n'+'\t  \t\t\t<span class="input-group-addon">Population</span>\n'+'\t  \t\t\t<input type="text" class="form-control" placeholder="Total number of patients" aria-describedby="basic-addon3" ng-model="projects.selectedProject.patients">\n'+"\t  \t\t</div>\t  \t\t\n"+'\x3c!-- \t  \t\t<div class="input-group">\n'+'\t  \t\t\t<span class="input-group-addon">User group (Optional)</span>\n'+'\t  \t\t\t<input type="text" class="form-control" placeholder="Restrict acces to your project to that group" aria-describedby="basic-addon3" ng-model="projects.selectedProject.scope">\n'+"\t  \t\t</div> --\x3e\n"+'\t  \t\t<div class="panel panel-default">\n'+'\t\t\t\t<div class="panel-heading">\n'+"\t\t\t    \tEdit project collections:\n"+"\t\t\t  \t</div>\n"+'\t\t  \t\t<div class="panel-body">\n'+'\t\t\t\t  \t<div class="col-md-6">\n'+'\t\t\t\t  \t\t<div class="panel panel-default" style="overflow:scroll">\n'+'\t\t\t\t\t\t\t<div class="panel-heading">\n'+"\t\t\t\t\t\t\t \tClinical collections\n"+"\t\t\t\t\t\t\t</div>\n"+'\t\t\t\t\t  \t\t<div class="panel-body">\n'+'\t\t\t\t\t  \t\t\t<table st-table="clinicalDataCollection.collections" st-sort="{{key}}" class="table table-striped">\n'+"\t\t\t\t\t\t\t\t\t<thead>\n"+"\t\t\t\t\t\t\t\t\t\t<tr>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>\n"+'\t\t\t\t\t\t        \t\t\t\t<input type="checkbox" aria-label="..." ng-model="clinicalCheckBox" ng-value="!clinicalCheckBox" ng-click="clinicalDataCollection.checkAll(clinicalCheckBox)">\n'+"\t\t\t\t\t\t\t\t        \t</th>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>Name</th>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>Number of items</th>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>Type</th> \n"+"\t\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t\t</thead>\n"+"\t\t\t\t\t\t\t\t\t<tbody>\n"+'\t\t\t\t\t\t\t\t\t\t<tr ng-repeat="collection in clinicalDataCollection.collections">\n'+"\t\t\t\t\t\t\t\t\t\t\t<td>\n"+'\t\t\t\t\t\t        \t\t\t\t<input type="checkbox" aria-label="..." checklist-model="clinicalDataCollection.selectedCollections" checklist-value="collection._id">\n'+"\t\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t        \t<td>\n"+'\t\t\t\t\t\t\t\t\t\t\t\t<a type="button" class="btn btn-default" href="#clinicalData?collectionId={{collection._id}}" target="blank">\n'+"\t\t\t\t\t\t\t        \t\t\t\t{{collection.name}}\n"+"\t\t\t\t\t\t\t        \t\t\t</a>\n"+"\t\t\t\t\t\t        \t\t\t</td>\n"+"\t\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t\t        \t\t{{collection.items.length}}\n"+"\t\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t\t        \t\t{{collection.type}}\n"+"\t\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t\t</tbody>\n"+"\t\t\t\t\t\t\t\t</table>\n"+"\t\t\t\t\t  \t\t</div>\n"+"\t\t\t\t\t  \t</div>\n"+"\t\t\t\t  \t</div>\n"+'\t\t\t\t  \t<div class="col-md-6">\n'+'\t\t\t\t\t  \t<div class="panel panel-default" style="overflow:scroll">\n'+'\t\t\t\t\t\t\t<div class="panel-heading">\n'+"\t\t\t\t\t\t\t \tMorphological collections\n"+"\t\t\t\t\t\t\t</div>\n"+'\t\t\t\t\t  \t\t<div class="panel-body">\n'+'\t\t\t\t\t  \t\t\t<table st-table="morphologicalDataCollection.collections" st-sort="{{key}}" class="table table-striped">\n'+"\t\t\t\t\t\t\t\t\t<thead>\n"+"\t\t\t\t\t\t\t\t\t\t<tr>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>\n"+'\t\t\t\t\t\t\t\t\t\t\t\t<input type="checkbox" aria-label="..." ng-model="morphologicalCheckBox" ng-value="!morphologicalCheckBox" ng-click="morphologicalDataCollection.checkAll(morphologicalCheckBox)">\n'+"\t\t\t\t\t\t\t\t        \t</th>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>Name</th>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>Number of items</th>\n"+"\t\t\t\t\t\t\t\t\t\t\t<th>Type</th> \n"+"\t\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t\t</thead>\n"+"\t\t\t\t\t\t\t\t\t<tbody>\n"+'\t\t\t\t\t\t\t\t\t\t<tr ng-repeat="collection in morphologicalDataCollection.collections">\n'+"\t\t\t\t\t\t\t\t\t\t\t<td>\n"+'\t\t\t\t\t\t        \t\t\t\t<input type="checkbox" aria-label="..." checklist-model="morphologicalDataCollection.selectedCollections" checklist-value="collection._id">\n'+"\t\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t        \t<td>\n"+'\t\t\t\t\t\t\t\t\t\t\t\t<a type="button" class="btn btn-default" href="#/morphologicalData?collectionId={{collection._id}}" target="blank">\n'+"\t\t\t\t\t\t\t\t        \t\t\t{{collection.name}}\n"+"\t\t\t\t\t\t\t\t        \t\t</a>\n"+"\t\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t\t        \t\t{{collection.items.length}}\n"+"\t\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t\t        \t\t{{collection.type}}\n"+"\t\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t\t</tbody>\n"+"\t\t\t\t\t\t\t\t</table>\n"+"\t\t\t\t\t  \t\t</div>\n"+"\t\t\t\t\t  \t</div>\n"+"\t\t\t\t  \t</div>\n"+"\t\t\t\t</div>\n"+"\t\t\t</div>\n"+'\t  \t\t<div class="btn-group">\n'+'\t\t\t\t <button type="button" class="btn btn-default" ng-click="projects.update(projects.selectedProject);projects.showSection = 0">\n'+'\t\t\t\t \t<span class="glyphicon glyphicon-ok"></span>\n'+"\t\t\t\t \tUpdate\n"+"\t\t\t\t </button>\n"+'\t\t\t\t <button type="button" class="btn btn-default" ng-click="projects.showSection = 0;projects.clearForm(false);">\n'+'\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n'+"\t\t\t\t \tCancel\n"+"\t\t\t\t </button>\n"+"\t\t\t\t</div>\n"+"\t\t  </div>\n"+"\t\t</div>\n"+"\t</div>\t\n"+"</div>\n"+'<div class="row" ng-if="projects.section == 1">\n'+'\t<div class="panel panel-success">\n'+'\t  <div class="panel-body">\n'+'\t  \t<div class="input-group">\n'+'  \t\t\t<span class="input-group-addon">Name</span>\n'+'  \t\t\t<input type="text" class="form-control" placeholder="Project name" aria-describedby="basic-addon3" ng-model="projects.newProject.name">\n'+"  \t\t</div>\n"+'  \t\t<div class="input-group">\n'+'  \t\t\t<span class="input-group-addon">Description</span>\n'+'  \t\t\t<input type="text" class="form-control" placeholder="Write description of the project" aria-describedby="basic-addon3" ng-model="projects.newProject.description">\n'+"  \t\t</div>\n"+'   \t\t<div class="input-group">\n'+'  \t\t\t<span class="input-group-addon">Population</span>\n'+'  \t\t\t<input type="text" class="form-control" placeholder="Total number of patients" aria-describedby="basic-addon3" ng-model="projects.newProject.patients">\n'+"  \t\t</div>\n"+'\x3c!--   \t\t<div class="input-group">\n'+'  \t\t\t<span class="input-group-addon">User group (Optional)</span>\n'+'  \t\t\t<input type="text" class="form-control" placeholder="Restrict acces to your project to that group" aria-describedby="basic-addon3" ng-model="projects.newProject.scope">\n'+"  \t\t</div> --\x3e\n"+'  \t\t<div class="panel panel-default">\n'+'\t\t\t<div class="panel-heading">\n'+"\t\t    \tAdd collections to the project:\n"+"\t\t  \t</div>\n"+'\t  \t\t<div class="panel-body">\n'+'\t\t\t  \t<div class="col-md-6">\n'+'\t\t\t  \t\t<div class="panel panel-default" style="overflow:scroll">\n'+'\t\t\t\t\t\t<div class="panel-heading">\n'+"\t\t\t\t\t\t \tClinical collections\n"+"\t\t\t\t\t\t</div>\n"+'\t\t\t\t  \t\t<div class="panel-body">\n'+'\t\t\t\t  \t\t\t<table st-table="clinicalDataCollection.collections" st-sort="{{key}}" class="table table-striped">\n'+"\t\t\t\t\t\t\t\t<thead>\n"+"\t\t\t\t\t\t\t\t\t<tr>\n"+"\t\t\t\t\t\t\t\t\t\t<th>\n"+'\t\t\t\t\t        \t\t\t\t<input type="checkbox" aria-label="..." ng-model="clinicalCheckBox" ng-value="!clinicalCheckBox" ng-click="clinicalDataCollection.checkAll(clinicalCheckBox)">\n'+"\t\t\t\t\t\t\t        \t</th>\n"+"\t\t\t\t\t\t\t\t\t\t<th>Name</th>\n"+"\t\t\t\t\t\t\t\t\t\t<th>Number of items</th>\n"+"\t\t\t\t\t\t\t\t\t\t<th>Type</th> \n"+"\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t</thead>\n"+"\t\t\t\t\t\t\t\t<tbody>\n"+'\t\t\t\t\t\t\t\t\t<tr ng-repeat="collection in clinicalDataCollection.collections">\n'+"\t\t\t\t\t\t\t\t\t\t<td>\n"+'\t\t\t\t\t        \t\t\t\t<input type="checkbox" aria-label="..." checklist-model="clinicalDataCollection.selectedCollections" checklist-value="collection._id">\n'+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t        \t<td>\n"+'\t\t\t\t\t\t\t\t\t\t\t<a type="button" class="btn btn-default" href="#clinicalData?collectionId={{collection._id}}" target="blank">\n'+"\t\t\t\t\t\t\t        \t\t\t{{collection.name}}\n"+"\t\t\t\t\t\t\t        \t\t</a>\n"+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t        \t\t{{collection.items.length}}\n"+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t        \t\t{{collection.type}}\n"+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t</tbody>\n"+"\t\t\t\t\t\t\t</table>\n"+"\t\t\t\t  \t\t</div>\n"+"\t\t\t\t  \t</div>\n"+"\t\t\t  \t</div>\n"+'\t\t\t  \t<div class="col-md-6">\n'+'\t\t\t\t  \t<div class="panel panel-default" style="overflow:scroll">\n'+'\t\t\t\t\t\t<div class="panel-heading">\n'+"\t\t\t\t\t\t \tMorphological collections\n"+"\t\t\t\t\t\t</div>\n"+'\t\t\t\t  \t\t<div class="panel-body">\n'+'\t\t\t\t  \t\t\t<table st-table="morphologicalDataCollection.collections" st-sort="{{key}}" class="table table-striped">\n'+"\t\t\t\t\t\t\t\t<thead>\n"+"\t\t\t\t\t\t\t\t\t<tr>\n"+"\t\t\t\t\t\t\t\t\t\t<th>\n"+'\t\t\t\t\t\t\t\t\t\t\t<input type="checkbox" aria-label="..." ng-model="morphologicalCheckBox" ng-value="!morphologicalCheckBox" ng-click="morphologicalDataCollection.checkAll(morphologicalCheckBox)">\n'+"\t\t\t\t\t\t\t        \t</th>\n"+"\t\t\t\t\t\t\t\t\t\t<th>Name</th>\n"+"\t\t\t\t\t\t\t\t\t\t<th>Number of items</th>\n"+"\t\t\t\t\t\t\t\t\t\t<th>Type</th> \n"+"\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t</thead>\n"+"\t\t\t\t\t\t\t\t<tbody>\n"+'\t\t\t\t\t\t\t\t\t<tr ng-repeat="collection in morphologicalDataCollection.collections">\n'+"\t\t\t\t\t\t\t\t\t\t<td>\n"+'\t\t\t\t\t        \t\t\t\t<input type="checkbox" aria-label="..." checklist-model="morphologicalDataCollection.selectedCollections" checklist-value="collection._id">\n'+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t        \t<td>\n"+'\t\t\t\t\t\t\t\t\t\t\t<a type="button" class="btn btn-default" href="#morphologicalData?collectionId={{collection._id}}" target="blank">\n'+"\t\t\t\t\t\t\t        \t\t\t{{collection.name}}\n"+"\t\t\t\t\t\t\t        \t\t</a>\n"+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t        \t\t{{collection.items.length}}\n"+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t        \t<td>\n"+"\t\t\t\t\t\t\t        \t\t{{collection.type}}\n"+"\t\t\t\t\t\t\t        \t</td>\n"+"\t\t\t\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t\t\t\t</tbody>\n"+"\t\t\t\t\t\t\t</table>\n"+"\t\t\t\t  \t\t</div>\n"+"\t\t\t\t  \t</div>\n"+"\t\t\t  \t</div>\n"+"\t\t\t</div>\n"+"\t\t</div>\n"+'  \t\t<div class="btn-group">\n'+'\t\t\t <button type="button" class="btn btn-default" ng-click="projects.create(projects.newProject);projects.clearForm(true);projects.section = 0">\n'+'\t\t\t \t<span class="glyphicon glyphicon-ok"></span>\n'+"\t\t\t \tCreate\n"+"\t\t\t </button>\n"+'\t\t\t <button type="button" class="btn btn-default" ng-click="projects.section = 0;projects.clearForm(false);">\n'+'\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n'+"\t\t\t \tCancel\n"+"\t\t\t </button>\n"+"\t\t\t</div>\n"+"\t  </div>\n"+"\t</div>\n"+'\t<div class="panel panel-default" style="overflow:scroll" ng-if="projects.showSection == 2">\n'+'\t\t<div class="panel-heading">\n'+"\t    \tManage project scopes\n"+"\t  \t</div>\n"+'  \t\t<div class="panel-body">\n'+'  \t\t\t<div class="panel panel-info">\n'+'\t  \t\t\t<table st-table="projects.displayedProjects" st-safe-src="projects.projects" class="table table-striped">\n'+"\t\t\t\t\t<thead>\n"+"\t\t\t\t\t\t<tr>\n"+"\t\t\t\t\t\t\t<th>\n"+'\t\t\t\t\t\t\t\t<input st-search="name" placeholder="search for project name" class="input-sm form-control" type="search"/>\n'+"\t\t\t\t\t\t\t</th>\n"+'\t\t\t\t\t\t\t<th colspan="{{userScopes.scopes.length}}">\n'+'\t\t\t\t\t\t\t\t<input st-search="scope" placeholder="search for scope" class="input-sm form-control" type="search"/>\n'+"\t\t\t\t\t\t\t</th>\n"+"\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t</thead>\n"+"\t\t\t\t\t<tbody>\n"+'\t\t\t\t\t\t<tr ng-repeat="project in projects.displayedProjects">\n'+"\t\t\t\t\t\t\t<td>{{project.name}}</td>\n"+'\t\t\t\t\t\t\t<td ng-repeat="us in userScopes.scopes">\n'+'\t\t\t\t\t\t\t\t<div class="input-group">\n'+'\t\t\t\t\t\t\t      <span class="input-group-addon">\n'+'\t\t\t\t\t\t\t        <input type="checkbox" aria-label="..." ng-model=\'checkbox\' ng-true-value="true" ng-false-value="false" ng-click="projects.addRemoveScope(project, us, checkbox)" ng-checked="projects.hasScope(project, us)">\n'+"\t\t\t\t\t\t\t      </span>\n"+'\t\t\t\t\t\t\t      <label class="form-control" >{{ us }}</label>\n'+"\t\t\t\t\t\t\t    </div>\n"+"\t\t\t\t\t\t\t</td>\n"+"\t\t\t\t\t\t</tr>\n"+"\t\t\t\t\t</tbody>\n"+"\t\t\t\t</table>\n"+"\t\t\t</div>\n"+"  \t\t</div>\n"+"  \t</div>\n"+"</div>")
}]);